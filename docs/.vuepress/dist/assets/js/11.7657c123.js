(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{375:function(t,s,a){t.exports=a.p+"assets/img/image-2.43ba3067.png"},376:function(t,s,a){t.exports=a.p+"assets/img/image-3.88a14b28.png"},377:function(t,s,a){t.exports=a.p+"assets/img/image-4.7273a5cf.png"},378:function(t,s,a){t.exports=a.p+"assets/img/image-5.b43cc01d.png"},379:function(t,s,a){t.exports=a.p+"assets/img/image-1.eea81469.png"},380:function(t,s,a){t.exports=a.p+"assets/img/image-6.8caf806b.png"},381:function(t,s,a){t.exports=a.p+"assets/img/image-7.74ade405.png"},382:function(t,s,a){t.exports=a.p+"assets/img/image-8.dbaf2c66.png"},383:function(t,s,a){t.exports=a.p+"assets/img/image-9.7909eebc.png"},384:function(t,s,a){t.exports=a.p+"assets/img/image-10.20029084.png"},385:function(t,s,a){t.exports=a.p+"assets/img/image-11.049de73f.png"},386:function(t,s,a){t.exports=a.p+"assets/img/image-12.d223cb2f.png"},387:function(t,s,a){t.exports=a.p+"assets/img/jenkins-6.15bf5254.png"},388:function(t,s,a){t.exports=a.p+"assets/img/jenkins-5.ef551a19.png"},389:function(t,s,a){t.exports=a.p+"assets/img/jenkins-3.e7587268.png"},390:function(t,s,a){t.exports=a.p+"assets/img/jenkins-4.d771cb92.png"},475:function(t,s,a){"use strict";a.r(s);var e=a(17),n=Object(e.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"自动部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#自动部署"}},[t._v("#")]),t._v(" 自动部署")]),t._v(" "),s("h2",{attrs:{id:"jenkins-github-实现项目自动化部署"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jenkins-github-实现项目自动化部署"}},[t._v("#")]),t._v(" jenkins + GitHub 实现项目自动化部署")]),t._v(" "),s("h3",{attrs:{id:"安装jenkins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装jenkins"}},[t._v("#")]),t._v(" 安装jenkins")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.jenkins.io/zh/doc/pipeline/tour/getting-started/#%E4%B8%8B%E8%BD%BD%E5%B9%B6%E8%BF%90%E8%A1%8C-jenkins",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://www.jenkins.io/zh/doc/pipeline/tour/getting-started/#下载并运行-jenkins"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"启动jenkins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动jenkins"}},[t._v("#")]),t._v(" 启动jenkins")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("java")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-jar")]),t._v(" jenkins.war "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--httpPort")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8080")]),t._v("\n")])])]),s("h3",{attrs:{id:"配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置"}},[t._v("#")]),t._v(" 配置")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("设置用户名密码和安装默认插件")])]),t._v(" "),s("li",[s("p",[t._v("github上生成token并保存\n"),s("img",{attrs:{src:a(375),alt:"alt text"}}),t._v(" "),s("img",{attrs:{src:a(376),alt:"alt text"}})])]),t._v(" "),s("li",[s("p",[t._v("配置项目回调\n"),s("img",{attrs:{src:a(377),alt:"alt text"}})])]),t._v(" "),s("li",[s("p",[t._v("新建任务\n"),s("img",{attrs:{src:a(378),alt:"alt text"}})])]),t._v(" "),s("li",[s("p",[t._v("进入系统配置\n"),s("img",{attrs:{src:a(379),alt:"alt text"}})])]),t._v(" "),s("li",[s("p",[t._v("添加github服务器\n"),s("img",{attrs:{src:a(380),alt:"alt text"}}),t._v(" "),s("img",{attrs:{src:a(381),alt:"alt text"}})])]),t._v(" "),s("li",[s("p",[t._v("进入项目配置\n"),s("img",{attrs:{src:a(382),alt:"alt text"}}),t._v(" "),s("img",{attrs:{src:a(383),alt:"alt text"}}),t._v(" "),s("img",{attrs:{src:a(384),alt:"alt text"}}),t._v(" "),s("img",{attrs:{src:a(385),alt:"alt text"}}),t._v(" "),s("img",{attrs:{src:a(386),alt:"alt text"}})])])]),t._v(" "),s("p",[t._v("配置的脚本：")]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" docs/.vuepress\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" build "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-t")]),t._v(" nginxwithdist "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 容器名称")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("CONTAINER_NAME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kb"')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 检查容器是否存在")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ps")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-a")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("grep")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-q")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${CONTAINER_NAME}")]),t._v('"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Container '),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${CONTAINER_NAME}")]),t._v(' exists. Removing it..."')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 停止并删除容器")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" stop "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${CONTAINER_NAME}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("rm")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${CONTAINER_NAME}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Container '),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${CONTAINER_NAME}")]),t._v(' does not exist."')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 重新创建容器")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Creating a new container named '),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${CONTAINER_NAME}")]),t._v('..."')]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${CONTAINER_NAME}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-p")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8000")]),t._v(":80 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-itd")]),t._v(" nginxwithdist\n")])])]),s("h4",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考：")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://blog.csdn.net/qq_32352777/article/details/109267847",target:"_blank",rel:"noopener noreferrer"}},[t._v("Jenkins 系列教程-史上最简单Jenkins教程，教你一天学会使用Jenkins利器"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://juejin.cn/post/6952765925388976165",target:"_blank",rel:"noopener noreferrer"}},[t._v("jenkins部署go程序(自动编译部署)"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://learnku.com/articles/44764",target:"_blank",rel:"noopener noreferrer"}},[t._v("jenkins + GitHub 实现项目自动化部署"),s("OutboundLink")],1)])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("在配置项目时候 Source Code Management 中 Git 的 Credentials 配置老是失败，还没找到原因，解决办法是在服务器生成 ssh key 添加到了 github，然后就 Credentials 就选择了 none")])]),t._v(" "),s("h2",{attrs:{id:"jenkins执行脚本npm-command-not-found解决"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jenkins执行脚本npm-command-not-found解决"}},[t._v("#")]),t._v(" jenkins执行脚本npm: command not found解决")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://blog.csdn.net/u011296165/article/details/96110294",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://blog.csdn.net/u011296165/article/details/96110294"),s("OutboundLink")],1)])]),t._v(" "),s("h2",{attrs:{id:"如何使用-rest-api-和-curl-构建作业"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何使用-rest-api-和-curl-构建作业"}},[t._v("#")]),t._v(" 如何使用 REST API 和 cURL 构建作业？")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("可用于 gitlab ci 之后执行脚本自动部署项目。")])]),t._v(" "),s("ul",[s("li",[t._v("示例构建：")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--user")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),t._v(":API_TOKEN "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-X")]),t._v(" POST https://localhost:8080/job/test/build\n")])])]),s("p",[t._v("代替：")]),t._v(" "),s("p",[s("code",[t._v("USER:API_TOKEN")]),t._v(" 使用您的用户名和 API 令牌")]),t._v(" "),s("p",[s("code",[t._v("localhost:8080")]),t._v(" 你的 Jenkins URL")]),t._v(" "),s("p",[s("code",[t._v("test")]),t._v(" 你的工作名称")]),t._v(" "),s("ul",[s("li",[t._v("使用字符串参数构建示例：")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--user")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),t._v(":API_TOKEN "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-X")]),t._v(" POST https://localhost:8080/job/test/build --data-urlencode "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"parameter": [{"name":"paramA", "value":"123"}]}\'')]),t._v("\n")])])]),s("p",[t._v("代替：")]),t._v(" "),s("p",[s("code",[t._v("USER:API_TOKEN")]),t._v(" 使用您的用户名和 API 令牌")]),t._v(" "),s("p",[s("code",[t._v("localhost:8080")]),t._v(" 你的 Jenkins URL")]),t._v(" "),s("p",[s("code",[t._v("test")]),t._v(" 你的工作名称")]),t._v(" "),s("p",[s("code",[t._v("paramA")]),t._v(" 你的参数名称")]),t._v(" "),s("p",[s("code",[t._v("123")]),t._v(" 你的参数值")]),t._v(" "),s("h3",{attrs:{id:"我的实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#我的实践"}},[t._v("#")]),t._v(" 我的实践：")]),t._v(" "),s("ul",[s("li",[t._v("添加参数：")])]),t._v(" "),s("p",[s("img",{attrs:{src:a(387),alt:""}})]),t._v(" "),s("ul",[s("li",[t._v("添加 shell 脚本")])]),t._v(" "),s("p",[s("img",{attrs:{src:a(388),alt:""}})]),t._v(" "),s("ul",[s("li",[t._v("调用 api:")])]),t._v(" "),s("div",{staticClass:"language-shell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-X")]),t._v(" POST http://jenkins.get123.xyz/job/test/build "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--user")]),t._v(" myUser:xxxxxxxxx "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n    --data-urlencode "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("json")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('\'{"parameter": [{"name":"BRANCH", "value":"master"},{"name":"SERVICES", "value":"order product"}]}\'')]),t._v("\n")])])]),s("ul",[s("li",[t._v("查看参数：")])]),t._v(" "),s("p",[s("img",{attrs:{src:a(389),alt:""}})]),t._v(" "),s("ul",[s("li",[t._v("查看输出：")])]),t._v(" "),s("p",[s("img",{attrs:{src:a(390),alt:""}})])])}),[],!1,null,null,null);s.default=n.exports}}]);