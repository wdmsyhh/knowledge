(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{344:function(v,_,i){"use strict";i.r(_);var t=i(14),l=Object(t.a)({},(function(){var v=this,_=v._self._c;return _("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[_("p",[v._v("title: Linux 常用排查命令\nspeaker: Jerome Ge")]),v._v(" "),_("slide"),v._v(" "),_("h1",{attrs:{id:"linux-常用排查命令"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#linux-常用排查命令"}},[v._v("#")]),v._v(" Linux 常用排查命令")]),v._v(" "),_("p",[v._v("Jerome Ge")]),v._v(" "),_("slide"),v._v(" "),_("h2",{attrs:{id:"分类"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#分类"}},[v._v("#")]),v._v(" 分类")]),v._v(" "),_("ul",[_("li",[v._v("通用")]),v._v(" "),_("li",[v._v("CPU")]),v._v(" "),_("li",[v._v("内存")]),v._v(" "),_("li",[v._v("磁盘")]),v._v(" "),_("li",[v._v("I/O")]),v._v(" "),_("li",[v._v("网络")])]),v._v(" "),_("slide"),v._v(" "),_("h3",{attrs:{id:"通用"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#通用"}},[v._v("#")]),v._v(" 通用")]),v._v(" "),_("ul",[_("li",[v._v("pstree")]),v._v(" "),_("li",[v._v("ps")]),v._v(" "),_("li",[v._v("htop")]),v._v(" "),_("li",[v._v("glances")]),v._v(" "),_("li",[v._v("vmstat")])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"pstree"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#pstree"}},[v._v("#")]),v._v(" pstree")]),v._v(" "),_("p",[v._v("pstree 命令可以显示正在运行的进程树，可以很直观的看到进程之间的相互关系。命令不指定任何参数，会把系统启动时的第一个进程作为基层，显示基层之后的所有进程。")]),v._v(" "),_("p",[v._v("命令用法：")]),v._v(" "),_("p",[_("code",[v._v("pstree [选项] [进程号] [用户]")])]),v._v(" "),_("p",[v._v("常用选项：")]),v._v(" "),_("ul",[_("li",[v._v("-a 显示命令参数")]),v._v(" "),_("li",[v._v("-c 不压缩雷同子进程")]),v._v(" "),_("li",[v._v("-p 显示进程号")]),v._v(" "),_("li",[v._v("-s 显示指定进程父进程")])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"ps"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ps"}},[v._v("#")]),v._v(" ps")]),v._v(" "),_("p",[v._v("ps 命令是强大的进程查看命令，可以查看进程用户、进程号、资源使用情况、运行状态等信息。")]),v._v(" "),_("p",[v._v("命令用法：")]),v._v(" "),_("p",[_("code",[v._v("ps [选项]")])]),v._v(" "),_("p",[v._v("常用选项：")]),v._v(" "),_("ul",[_("li",[v._v("a 显示带有终端（tty）的所有进程")]),v._v(" "),_("li",[v._v("x 显示当前用户的所有进程，连同 a 列出所有进程")]),v._v(" "),_("li",[v._v("u 显示面向用户的格式")]),v._v(" "),_("li",[v._v("v 显示虚拟内存格式")]),v._v(" "),_("li",[v._v("-e 显示全部进程")]),v._v(" "),_("li",[v._v("-f 显示完整格式的进程信息")]),v._v(" "),_("li",[v._v("-t 显示与终端相关联的所有进程")]),v._v(" "),_("li",[v._v("-p 显示进程使用的 cpu 时间")]),v._v(" "),_("li",[v._v("-u 显示指定用户的的进程状态")]),v._v(" "),_("li",[v._v("-L 显示指定进程的线程")])]),v._v(" "),_("p",[v._v("最常用的方法是 "),_("code",[v._v("ps aux")]),v._v(" 和 "),_("code",[v._v("ps -ef")]),v._v(" 列出所有进程后再用 "),_("code",[v._v("grep")]),v._v(" 过滤。也可以用 "),_("code",[v._v("ps -aux --sort -pmem | less")]),v._v(" 和 "),_("code",[v._v("ps -aux --sort -pcpu | less")]),v._v(" 按内存或 CPU 升序查看进程，或使用 "),_("code",[v._v("ps -aux --sort -pcpu,+pmem | head -n 10")]),v._v(" 组合命令显示前 10 个资源使用率高进程。")]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"ps-2"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ps-2"}},[v._v("#")]),v._v(" ps")]),v._v(" "),_("p",[v._v("字段含义：")]),v._v(" "),_("ul",[_("li",[v._v("USER（UID）：进程所属用户")]),v._v(" "),_("li",[v._v("PID：进程号")]),v._v(" "),_("li",[v._v("PPID：父进程号")]),v._v(" "),_("li",[v._v("%CPU：进程的 CPU 占用率")]),v._v(" "),_("li",[v._v("%MEM：进程的内存占用率")]),v._v(" "),_("li",[v._v("VSZ：进程使用的虚拟内存的大小，单位是 Kbytes")]),v._v(" "),_("li",[v._v("RSS：进程实际使用内存的大小，单位是 Kbytes")]),v._v(" "),_("li",[v._v("TTY：与进程关联的终端")]),v._v(" "),_("li",[v._v("STAT：进程的状态，使用 STAT 状态码表示")]),v._v(" "),_("li",[v._v("STIME：启动时间")]),v._v(" "),_("li",[v._v("TIME：进程使用的 CPU 总时间")]),v._v(" "),_("li",[v._v("COMMAND（CMD）：执行的命令")])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"ps-3"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ps-3"}},[v._v("#")]),v._v(" ps")]),v._v(" "),_("p",[v._v("STAT 状态：")]),v._v(" "),_("ul",[_("li",[v._v("R：运行，正在运行或在运行队列中等待")]),v._v(" "),_("li",[v._v("S：中断，休眠中、受阻、在等待某个事件或信号")]),v._v(" "),_("li",[v._v("D：不可中断，不可中断的休眠，通常是IO")]),v._v(" "),_("li",[v._v("T：停止，进程收到 SIGSTOP、SIGSTP、SIGTIN、SIGTOU 信号后停止运行")]),v._v(" "),_("li",[v._v("Z：僵尸，进程已终止，但进程描述符还存在，需等父进程调用 wait4() 系统调用后释放")]),v._v(" "),_("li",[v._v("<：高优先级进程")]),v._v(" "),_("li",[v._v("N：低优先级进程")]),v._v(" "),_("li",[v._v("L：有 pages 在内存中 locked")]),v._v(" "),_("li",[v._v("s：进程有子进程")]),v._v(" "),_("li",[v._v("l：多线程")]),v._v(" "),_("li",[v._v("+：位于前台的进程组")])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"htop"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#htop"}},[v._v("#")]),v._v(" htop")]),v._v(" "),_("p",[v._v("htop 是 top 的升级版，上半部分可直观的看到 CPU 核数及使用情况、内存或交换使用情况、进程数（task）、线程数（thread）、load、uptime；下半部分可以看到每个进程或线程的详细信息。")]),v._v(" "),_("p",[v._v("字段含义：")]),v._v(" "),_("ul",[_("li",[v._v("PID：进程或线程号")]),v._v(" "),_("li",[v._v("USER：所属用户")]),v._v(" "),_("li",[v._v("PRI：优先级")]),v._v(" "),_("li",[v._v("NI：由用户或 root 用户重置的优先级")]),v._v(" "),_("li",[v._v("VIR：使用的虚拟内存")]),v._v(" "),_("li",[v._v("RES：使用的物理内存")]),v._v(" "),_("li",[v._v("SHR：使用的共享内存")]),v._v(" "),_("li",[v._v("S：进程的状态")]),v._v(" "),_("li",[v._v("CPU%：CPU 占用率")]),v._v(" "),_("li",[v._v("MEM%：内存占用率")]),v._v(" "),_("li",[v._v("TIME+：开始执行以来的时间")]),v._v(" "),_("li",[v._v("Command：执行的命令")])]),v._v(" "),_("p",[v._v("可以使用 F6 选择不同的列按升级排列；使用 F5 按子父关系显示；使用 F3 进行搜索等。")]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"glances"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#glances"}},[v._v("#")]),v._v(" glances")]),v._v(" "),_("p",[v._v("glances 提供了 CPU 使用率、内存和交换使用率、load、磁盘 I/O、磁盘使用率、网络 I/O、容器使用率、进程监控、网页查看等功能，如果有兴趣可以研究下。")]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"vmstat"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#vmstat"}},[v._v("#")]),v._v(" vmstat")]),v._v(" "),_("p",[v._v("vmstat 可对操作系统的虚拟内存、进程、CPU 进行监控，可对系统的整体情况进行分析。")]),v._v(" "),_("p",[v._v("命令用法：")]),v._v(" "),_("p",[_("code",[v._v("vmstat [选项] [间隔 [次数]]")])]),v._v(" "),_("p",[v._v("常用选项：")]),v._v(" "),_("ul",[_("li",[v._v("-a 显示活跃和非活跃内存")]),v._v(" "),_("li",[v._v("-f 显示系统启动到现在的 fork 数量")]),v._v(" "),_("li",[v._v("-m 显示 slabinfo")]),v._v(" "),_("li",[v._v("-n 仅显示一次标题")]),v._v(" "),_("li",[v._v("-s 显示内存相关统计信息及多种系统活动数量")]),v._v(" "),_("li",[v._v("-d 显示磁盘统计信息")]),v._v(" "),_("li",[v._v("-D 显示有关磁盘活动的一些摘要统计信息")]),v._v(" "),_("li",[v._v("-p 显示指定磁盘分区统计信息")]),v._v(" "),_("li",[v._v("-w 宽输出模式")]),v._v(" "),_("li",[v._v("-t 将时间戳附加到每行")])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"vmstat-2"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#vmstat-2"}},[v._v("#")]),v._v(" vmstat")]),v._v(" "),_("p",[v._v("字段含义：")]),v._v(" "),_("ul",[_("li",[v._v("procs\n"),_("ul",[_("li",[v._v("r：正在运行或正在等待运行的进程数")]),v._v(" "),_("li",[v._v("b：等待 I/O 的进程数")])])]),v._v(" "),_("li",[v._v("memory\n"),_("ul",[_("li",[v._v("swpd：使用的交换内存量")]),v._v(" "),_("li",[v._v("free：空闲物理内存量")]),v._v(" "),_("li",[v._v("buff：用作缓冲的内存量")]),v._v(" "),_("li",[v._v("cache：用作缓存的内存量")]),v._v(" "),_("li",[v._v("inact：不活动的内存量")]),v._v(" "),_("li",[v._v("active：活动内存量")])])]),v._v(" "),_("li",[v._v("swap\n"),_("ul",[_("li",[v._v("si：每秒从交换区写到内存的大小，由磁盘调入内存")]),v._v(" "),_("li",[v._v("so：每秒写入交换区的内存大小，由内存调入磁盘")])])]),v._v(" "),_("li",[v._v("io\n"),_("ul",[_("li",[v._v("bi：每秒接收的块数")]),v._v(" "),_("li",[v._v("bo：每秒写入的块数")])])]),v._v(" "),_("li",[v._v("system\n"),_("ul",[_("li",[v._v("in：每秒中断数，包括时钟")]),v._v(" "),_("li",[v._v("cs：每秒上下文切换数")])])]),v._v(" "),_("li",[v._v("cpu\n"),_("ul",[_("li",[v._v("us：用户进程执行时间百分比")]),v._v(" "),_("li",[v._v("sy：系统进程执行时间百分比")]),v._v(" "),_("li",[v._v("id：空闲时间百分比")]),v._v(" "),_("li",[v._v("wa：I/O 等待时间百分比")]),v._v(" "),_("li",[v._v("st：等待宿主机为其他虚拟 CPU 提供服务的时间百分比")])])])]),v._v(" "),_("slide"),v._v(" "),_("h3",{attrs:{id:"cpu"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#cpu"}},[v._v("#")]),v._v(" CPU")]),v._v(" "),_("h4",{attrs:{id:"mpstat"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#mpstat"}},[v._v("#")]),v._v(" mpstat")]),v._v(" "),_("p",[v._v("可使用 "),_("code",[v._v("mpstat -P ALL 2 10")]),v._v(" 命令查看所有 CPU 的统计数据，每 2 秒输出一次，共输出 10 次。")]),v._v(" "),_("p",[v._v("字段含义：")]),v._v(" "),_("ul",[_("li",[v._v("%usr：用户进程执行时间百分比")]),v._v(" "),_("li",[v._v("%nice：执行用户带 nice 优先级的的进程执行时间百分比")]),v._v(" "),_("li",[v._v("%sys：系统进程执行时间百分比，不包括硬、软中断")]),v._v(" "),_("li",[v._v("%iowait：I/O 等待时间百分比")]),v._v(" "),_("li",[v._v("%irq：硬中断的时间百分比")]),v._v(" "),_("li",[v._v("%soft：硬中断时间百分比")]),v._v(" "),_("li",[v._v("%steal：等待宿主机为其他虚拟 CPU 提供服务的时间百分比")]),v._v(" "),_("li",[v._v("%guest：宿主机角度运行虚拟 CPU 的时间百分比")]),v._v(" "),_("li",[v._v("%gnice：宿主机角度运行带有 nice 优先级 CPU 的时间百分比")]),v._v(" "),_("li",[v._v("%idle：空闲时间百分比")])]),v._v(" "),_("slide"),v._v(" "),_("h3",{attrs:{id:"内存"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#内存"}},[v._v("#")]),v._v(" 内存")]),v._v(" "),_("h4",{attrs:{id:"free"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#free"}},[v._v("#")]),v._v(" free")]),v._v(" "),_("p",[v._v("统计内存和交换使用情况，可使用 "),_("code",[v._v("free -h")]),v._v(" 命令查看，字段含义如下：")]),v._v(" "),_("ul",[_("li",[v._v("total：表示物理内存或交换的总大小")]),v._v(" "),_("li",[v._v("used：已使用物理内存或交换，不包含 buff/cache")]),v._v(" "),_("li",[v._v("free：可用物理内存或交换")]),v._v(" "),_("li",[v._v("shared：多个进程共享的内存量")]),v._v(" "),_("li",[v._v("buff/cache：缓存量，包含以下内容\n"),_("ul",[_("li",[v._v("buffer：内核缓冲区使用的内存")]),v._v(" "),_("li",[v._v("cache：page cache 和 slab 所占用的内存之和，slab 使用可用 "),_("code",[v._v("slabtop")]),v._v(" 命令查看")])])]),v._v(" "),_("li",[v._v("available：可用物理内存，是 free 加上可回收 page cache 和 slab 值的总和")])]),v._v(" "),_("slide"),v._v(" "),_("h3",{attrs:{id:"磁盘"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#磁盘"}},[v._v("#")]),v._v(" 磁盘")]),v._v(" "),_("ul",[_("li",[v._v("du")]),v._v(" "),_("li",[v._v("df")]),v._v(" "),_("li",[v._v("iozone")])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"du"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#du"}},[v._v("#")]),v._v(" du")]),v._v(" "),_("p",[v._v("显示目录或文件的大小，查找文件和目录的磁盘使用情况。")]),v._v(" "),_("p",[v._v("示例：")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("du -sh")]),v._v(" 统计当前目录的大小，以直观方式展现")]),v._v(" "),_("li",[_("code",[v._v("du -sh * | sort - rh")]),v._v(" 查看目录下文件的大小并按排序")]),v._v(" "),_("li",[_("code",[v._v("du -h --max-depth=1 | sort")]),v._v(" 查看目录下所有一级目录大小并排序")])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"df"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#df"}},[v._v("#")]),v._v(" df")]),v._v(" "),_("p",[v._v("显示磁盘分区摘要信息，如分区格式、空间大小、已用空间、可用空间、挂载信息等，一般使用 "),_("code",[v._v("df -Th")]),v._v(" 查看。")]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"iozone"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#iozone"}},[v._v("#")]),v._v(" iozone")]),v._v(" "),_("p",[v._v("磁盘性能测试工具，可测试磁盘的顺序读写和随机读机速度。常用参数如下：")]),v._v(" "),_("ul",[_("li",[v._v("-a 全自动模式，使用的块大小从 4k 到 16M，文件大小从 64k 到 512M")]),v._v(" "),_("li",[v._v("-b 输出结果时将创建一个兼容 Excel 的二进格式的文件")]),v._v(" "),_("li",[v._v("-c 计算时间时将 clone() 包括进来。")]),v._v(" "),_("li",[v._v("-e 计算时间时将 flush（fsync，fflush）包括进来")]),v._v(" "),_("li",[v._v("-g 设置自动模式可使用的最大文件大小，单位是 Kbytes")]),v._v(" "),_("li",[v._v("-i 用来指定运行哪个测试（0=write/rewrite，1=read/re-read，2=random-read/write，3=Read-backwards，4=Re-write-record，5=stride-read，6=fwrite/re-fwrite，7=fread/Re-fread,8=random mix，9=pwrite/Re-pwrite，10=pread/Re-pread，11=pwritev/Re-pwritev，12=preadv/Re-preadv）")]),v._v(" "),_("li",[v._v("-K 在普通测试时生成一些随机访问")]),v._v(" "),_("li",[v._v("-n 自动模式设置最小文件大小")]),v._v(" "),_("li",[v._v("-N 报告结果以毫秒每操作的方式显示")]),v._v(" "),_("li",[v._v("-r 指定测试块大小")]),v._v(" "),_("li",[v._v("-s 指定测试文件大小")]),v._v(" "),_("li",[v._v("-t 指定测试时使用多少个线程或进程")]),v._v(" "),_("li",[v._v("-w 当临时文件使用完毕后不删除")]),v._v(" "),_("li",[v._v("-y 设置自动模式下使用的最小块大小")])]),v._v(" "),_("p",[v._v("示例")]),v._v(" "),_("p",[_("code",[v._v("iozone -s 10G -r 4k -i 0 -i 1 -i 2")]),v._v(" 设置测试文件为 10G，测试块大小为 4K，只测试顺序读写和随机读写。")]),v._v(" "),_("slide"),v._v(" "),_("h3",{attrs:{id:"i-o"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#i-o"}},[v._v("#")]),v._v(" I/O")]),v._v(" "),_("h4",{attrs:{id:"iotop"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#iotop"}},[v._v("#")]),v._v(" iotop")]),v._v(" "),_("p",[v._v("iotop 可以显示实时的磁盘活动，监控内核输出的 I/O 使用信息，并显示系统中进程或线程的当前 I/O 使用情况。常用参数如下：")]),v._v(" "),_("ul",[_("li",[v._v("-o 只显示正在产生 I/O 的进程或线程，可按 o 切换")]),v._v(" "),_("li",[v._v("-n 设置监控显示次数，默认是无限")]),v._v(" "),_("li",[v._v("-d 设置显示的间隔秒数")]),v._v(" "),_("li",[v._v("-p 只显示指定进程的信息")]),v._v(" "),_("li",[v._v("-P 只显示进程，不显示线程，可以按 p 切换")]),v._v(" "),_("li",[v._v("-k 使用 KB 为单位显示")])]),v._v(" "),_("p",[v._v("字段含义：")]),v._v(" "),_("ul",[_("li",[v._v("Total DISK READ：进程和线程总的读取量")]),v._v(" "),_("li",[v._v("Total DISK WRITE：进程和线程总的写入量")]),v._v(" "),_("li",[v._v("Actual DISK READ：内核块设备子系统和磁盘实际磁盘读取量")]),v._v(" "),_("li",[v._v("Actual DISK WRITE：内核块设备子系统和磁盘实际磁盘写入量")]),v._v(" "),_("li",[v._v("TID：线程或进程号")]),v._v(" "),_("li",[v._v("PRIO：运行时的 I/O 优先级")]),v._v(" "),_("li",[v._v("USER：所属用户")]),v._v(" "),_("li",[v._v("DISK READ：刷新时间间隔内读取量")]),v._v(" "),_("li",[v._v("DISK WRITE：刷新时间间隔内写入量")]),v._v(" "),_("li",[v._v("SWAPIN：交换使用率")]),v._v(" "),_("li",[v._v("IO>：I/O 利用率，包含磁盘和交换")]),v._v(" "),_("li",[v._v("COMMAND：执行的命令")])]),v._v(" "),_("slide"),v._v(" "),_("h3",{attrs:{id:"网络"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#网络"}},[v._v("#")]),v._v(" 网络")]),v._v(" "),_("ul",[_("li",[v._v("iftop")]),v._v(" "),_("li",[v._v("telnet")]),v._v(" "),_("li",[v._v("curl")]),v._v(" "),_("li",[v._v("dig")]),v._v(" "),_("li",[v._v("mtr")]),v._v(" "),_("li",[v._v("ss")]),v._v(" "),_("li",[v._v("netstat")]),v._v(" "),_("li",[v._v("tcpdump")])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"iftop"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#iftop"}},[v._v("#")]),v._v(" iftop")]),v._v(" "),_("p",[v._v("iftop 可用来统计本机网络流量以及和其他地址通信的实量流量，常用参数如下：")]),v._v(" "),_("ul",[_("li",[v._v("-i 指定需要检测的网卡")]),v._v(" "),_("li",[v._v("-n 将输出的主机信息都通过 IP 显示")]),v._v(" "),_("li",[v._v("-P 显示主机以及端口号")]),v._v(" "),_("li",[v._v("-F 显示指定网段的进出流量")])]),v._v(" "),_("p",[v._v("字段含义：")]),v._v(" "),_("ul",[_("li",[v._v("TX：发送的数据量")]),v._v(" "),_("li",[v._v("RX：接收的数据量")]),v._v(" "),_("li",[v._v("TOTAL：发送和接收的总数据量")]),v._v(" "),_("li",[v._v("cum：从 iftop 运行到目前的发送、接收和总数据量")]),v._v(" "),_("li",[v._v("peak：发送、接收以及总的峰值")]),v._v(" "),_("li",[v._v("rates：过去 2s、10s、40s 的平均值")])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"telnet"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#telnet"}},[v._v("#")]),v._v(" telnet")]),v._v(" "),_("p",[v._v("telnet 用于登陆远程主机，对远程主机进行管理，采用明文传输，安全性较差。目前一般用来测试端口的连通性。")]),v._v(" "),_("p",[v._v("命令用法：")]),v._v(" "),_("p",[_("code",[v._v("telnet [选项] [主机] [端口]")])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"curl"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#curl"}},[v._v("#")]),v._v(" curl")]),v._v(" "),_("p",[v._v("curl 是在命令行方式下与服务器之间传输文件和数据的工具，支持的协议包含 HTTP、HTTPS、FTP、SMTP、TELNET 等协议。")]),v._v(" "),_("p",[v._v("命令用法：")]),v._v(" "),_("p",[_("code",[v._v("curl [选项] [URL]")])]),v._v(" "),_("p",[v._v("常用选项：")]),v._v(" "),_("ul",[_("li",[v._v("-i 显示 Response 的 Header 信息")]),v._v(" "),_("li",[v._v("-I 发送 HEAD 请求并显示 Header 信息")]),v._v(" "),_("li",[v._v("-v 输出通信的整个过程，用于调试")]),v._v(" "),_("li",[v._v("-k 跳过 SSL 证书检测")]),v._v(" "),_("li",[v._v("-w 在请求成功完成后输出指定信息到标准输出，如 DNS 解析时间（time_namelookup），详细内容请参考"),_("a",{attrs:{href:"https://everything.curl.dev/usingcurl/verbose/writeout#available-write-out-variables",target:"_blank",rel:"noopener noreferrer"}},[v._v("文档"),_("OutboundLink")],1)]),v._v(" "),_("li",[v._v("-L 让 HTTP 请求跟随服务器的重定向")]),v._v(" "),_("li",[v._v("--limit-rate 限制 HTTP 请求和返回的带宽，模拟网速慢的环境")]),v._v(" "),_("li",[v._v("-s 不输出错误和进度信息")]),v._v(" "),_("li",[v._v("-X 指定 HTTP method，如 GET、POST、PUT、DELETE")]),v._v(" "),_("li",[v._v("-H 设置 Header")]),v._v(" "),_("li",[v._v("-e 设置 Referer 值，也可以在 -H 中设置")]),v._v(" "),_("li",[v._v("-d 设置 POST 方法的数据体（HTTP Body）")]),v._v(" "),_("li",[v._v("-G 使用 GET 方法发送数据体（HTTP Body）")]),v._v(" "),_("li",[v._v("-u 设置服务器认证的用户名和密码")]),v._v(" "),_("li",[v._v("-b 向服务器发送 Cookie")]),v._v(" "),_("li",[v._v("-A 设置 User-Agent 值，也可以在 -H 中设置")]),v._v(" "),_("li",[v._v("-C 断点续传")]),v._v(" "),_("li",[v._v("-x 设置请求的代理")]),v._v(" "),_("li",[v._v("-U 设置代理认证的用户名和密码")]),v._v(" "),_("li",[v._v("-o 将输出写入文件")]),v._v(" "),_("li",[v._v("-D 将 Header 信息写入指定文件")])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"curl-2"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#curl-2"}},[v._v("#")]),v._v(" curl")]),v._v(" "),_("p",[v._v("示例：")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("curl -Iv https://www.maiscrm.com")])]),v._v(" "),_("li",[_("code",[v._v("curl -L http://www.maiscrm.com")])]),v._v(" "),_("li",[_("code",[v._v("curl -o maiscrm.html https://www.maiscrm.com")])]),v._v(" "),_("li",[_("code",[v._v('curl -o /dev/null -s -w "time_namelookup: %{time_namelookup}\\n" https://www.maiscrm.com')])])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"dig"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#dig"}},[v._v("#")]),v._v(" dig")]),v._v(" "),_("p",[v._v("dig 是一个简单易用的域名解析查询工具。")]),v._v(" "),_("p",[v._v("命令用法：")]),v._v(" "),_("p",[_("code",[v._v("dig [@域名服务器] [域名] [选项]")])]),v._v(" "),_("p",[v._v("常用选项：")]),v._v(" "),_("ul",[_("li",[v._v("-b 指定用本机的哪个 IP 地址向域名服务器发送域名查询请求")]),v._v(" "),_("li",[v._v("-f 从文件中读取需要解析的域名列表，每行一个")]),v._v(" "),_("li",[v._v("-t 配置查询类型，缺省类型是 A")]),v._v(" "),_("li",[v._v("tcp 连接域名服务器时使用 TCP 协议")]),v._v(" "),_("li",[v._v("short 显示简要的输出")])]),v._v(" "),_("p",[v._v("示例：")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("dig maiscrm.com")])]),v._v(" "),_("li",[_("code",[v._v("dig maiscrm.com +short")])]),v._v(" "),_("li",[_("code",[v._v("dig maiscrm.com -t txt")])])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"mtr"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#mtr"}},[v._v("#")]),v._v(" mtr")]),v._v(" "),_("p",[v._v("mtr 是一个网络诊断工具，可检查到服务器的每个节点丢包、延迟等原因。")]),v._v(" "),_("p",[v._v("命令用法：")]),v._v(" "),_("p",[_("code",[v._v("mtr [选项] [域名或IP地址]")])]),v._v(" "),_("p",[v._v("常用选项：")]),v._v(" "),_("ul",[_("li",[v._v("-u 使用 UDP 数据包，而不是 ICMP")]),v._v(" "),_("li",[v._v("-r 生成报告，只会发送 10 个数据包，如果想要发送更多数据包，可以使用 -c 配置")]),v._v(" "),_("li",[v._v("-a 设置发送数据包的 IP 地址")]),v._v(" "),_("li",[v._v("-s 指定发送的数据包大小，单位是字节")]),v._v(" "),_("li",[v._v("-c 指定发送数据包的数量")]),v._v(" "),_("li",[v._v("-4 只使用 IPv4")])]),v._v(" "),_("p",[v._v("字段含义：")]),v._v(" "),_("ul",[_("li",[v._v("Host：到服务器经过的每个节点的 IP 或名称")]),v._v(" "),_("li",[v._v("Loss%：对应节点的丢包率")]),v._v(" "),_("li",[v._v("Snt：已发送的数据包数量")]),v._v(" "),_("li",[v._v("Last：最后一个数据包的响应时间")]),v._v(" "),_("li",[v._v("Avg：平均响应时间")]),v._v(" "),_("li",[v._v("Best：最短响应时间")]),v._v(" "),_("li",[v._v("Wrst：最长响应时间")]),v._v(" "),_("li",[v._v("StDev：标准偏差，偏差值越高说明各个数据包在该节点的响应时间相差越大")])]),v._v(" "),_("p",[v._v("示例：")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("mtr maiscrm.com")])]),v._v(" "),_("li",[_("code",[v._v("mtr -r maiscrm.com")])])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"ss"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#ss"}},[v._v("#")]),v._v(" ss")]),v._v(" "),_("p",[v._v("ss 可以获取 socket（套接字） 统计信息，可以显示更多更详继的 TCP 连接状态信息，比 netstat 更快更高效。")]),v._v(" "),_("p",[v._v("命令用法：")]),v._v(" "),_("p",[_("code",[v._v("ss [选项] [过滤器]")])]),v._v(" "),_("p",[v._v("常用选项：")]),v._v(" "),_("ul",[_("li",[v._v("-4 只显示 IPv4 套接字")]),v._v(" "),_("li",[v._v("-6 只显示 IPv6 套接字")]),v._v(" "),_("li",[v._v("-t 只显示 TCP 套接字")]),v._v(" "),_("li",[v._v("-u 只显示 UDP 套接字")]),v._v(" "),_("li",[v._v("-d 只显示 DCCP 套接字")]),v._v(" "),_("li",[v._v("-w 只显示 RAW 套接字")]),v._v(" "),_("li",[v._v("-w 只显示 Unix 套接字")]),v._v(" "),_("li",[v._v("-l 显示正监听的套接字")]),v._v(" "),_("li",[v._v("-m 使用套接字的内存使用情况")]),v._v(" "),_("li",[v._v("-p 显示套接字的进程")]),v._v(" "),_("li",[v._v("-a 显示所有套接字信息")]),v._v(" "),_("li",[v._v("-s 显示套接字使用概况")]),v._v(" "),_("li",[v._v("-D 不显示任何信息，将原始 TCP socket 信息存到指定文件")]),v._v(" "),_("li",[v._v("-f 只显示指定类型的 socket，如 unix、inet、inet6、link、netlink")])]),v._v(" "),_("p",[v._v("示例：")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("ss -ta")]),v._v(" 显示所有 TCP 连接信息")]),v._v(" "),_("li",[_("code",[v._v("ss -ua")]),v._v(" 显示所有 UDP 连接信息")]),v._v(" "),_("li",[_("code",[v._v("ss -o state established '(dport = :ssh or sport = :ssh )'")]),v._v(" 显示状态为 established 的 SSH 连接")]),v._v(" "),_("li",[_("code",[v._v("ss -tan|awk 'NR>1{++S[$1]}END{for (a in S) print a,S[a]}'")]),v._v(" 统计各状态连接信息，状态值含义请阅读 "),_("a",{attrs:{href:"https://www.masterraghu.com/subjects/np/introduction/unix_network_programming_v1.3/ch02lev1sec6.html",target:"_blank",rel:"noopener noreferrer"}},[v._v("TCP 连接的建立和终止过程"),_("OutboundLink")],1)])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"netstat"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#netstat"}},[v._v("#")]),v._v(" netstat")]),v._v(" "),_("p",[v._v("netstat 命令可以用来查看实际网络连接、路由表、网络统计数据等。")]),v._v(" "),_("p",[v._v("命令用法：")]),v._v(" "),_("p",[_("code",[v._v("netstat [选项]")])]),v._v(" "),_("p",[v._v("常用选项：")]),v._v(" "),_("ul",[_("li",[v._v("-a 显示所有连接中的套接字")]),v._v(" "),_("li",[v._v("-c 持续列出网络状态")]),v._v(" "),_("li",[v._v("-i 显示网络界面信息表单")]),v._v(" "),_("li",[v._v("-l 显示监听中的套接字")]),v._v(" "),_("li",[v._v("-n 使用 IP 地址显示")]),v._v(" "),_("li",[v._v("-r 显示路由表")]),v._v(" "),_("li",[v._v("-s 显示网络工作信息统计")]),v._v(" "),_("li",[v._v("-t 只显示 TCP 套接字")]),v._v(" "),_("li",[v._v("-u 只显示 UDP 套接字")]),v._v(" "),_("li",[v._v("-w 只显示 RAM 套接字")]),v._v(" "),_("li",[v._v("-v 显示指令执行过程")])]),v._v(" "),_("p",[v._v("示例：")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("netstat -ntl")]),v._v(" 显示正在监听的 TCP 信息")]),v._v(" "),_("li",[_("code",[v._v("netstat -antp | grep ssh")]),v._v(" 查看 SSH 连接信息")]),v._v(" "),_("li",[_("code",[v._v("netstat -an|awk '/^tcp/{++S[$NF]}END{for(a in S) print a,S[a]}'")]),v._v(" 统计各状态连接信息，状态值含义请阅读 "),_("a",{attrs:{href:"https://www.masterraghu.com/subjects/np/introduction/unix_network_programming_v1.3/ch02lev1sec6.html",target:"_blank",rel:"noopener noreferrer"}},[v._v("TCP 连接的建立和终止过程"),_("OutboundLink")],1)])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"tcpdump"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#tcpdump"}},[v._v("#")]),v._v(" tcpdump")]),v._v(" "),_("p",[v._v("tcpdump 是 Linux 系统上最常用的抓包工具，用来抓取网络通信中的数据包并进行分析。在网络性能急剧下降的时候，可以通过 tcpdump 工具分析原因，找出造成网络阻塞的来源。tcpdump 支持针对网络层、协议、主机、网络接口或端口的过滤，并提供 and、or、not 等逻辑语句过滤不必要的信息。")]),v._v(" "),_("p",[v._v("命令用法：")]),v._v(" "),_("p",[_("code",[v._v("tcpdump [选项] [-c 数量] [-F 文件名] [-i 网络接口] [-r 文件名] [-s snaplen] [-T 类型] [-w 文件名] [表达式]")])]),v._v(" "),_("p",[v._v("常用选项：")]),v._v(" "),_("ul",[_("li",[v._v("-A 以 ASCII 码方式显示每一个数据包，在程序调试时可方便查看数据")]),v._v(" "),_("li",[v._v("-a 将网络地址和广播地址转变成名字")]),v._v(" "),_("li",[v._v("-c 将接收到指定数目的数据包后退出")]),v._v(" "),_("li",[v._v("-d 将匹配信息包的代码以人们能够理解的汇编格式输出")]),v._v(" "),_("li",[v._v("-f 将外部的 Internet 地址以数字的形式打印出来")]),v._v(" "),_("li",[v._v("-F 使用文件作为过滤条件表达式的输入，命令行上的输入将被忽略")]),v._v(" "),_("li",[v._v("-i 指定监听的网络接口")]),v._v(" "),_("li",[v._v("-l 使标准输出变为缓冲形式")]),v._v(" "),_("li",[v._v("-n 不把网络地址转换为名字")]),v._v(" "),_("li",[v._v("-N 不打印出 host 的域名部分")]),v._v(" "),_("li",[v._v("-q 打印很少的协议相关信息，从而输出行都比较简短")]),v._v(" "),_("li",[v._v("-r 从文件中读取包数据")]),v._v(" "),_("li",[v._v("-s 设置数据包抓取长度，默认为 68 字节")]),v._v(" "),_("li",[v._v("-t 在输出的每一行不打印时间戳")]),v._v(" "),_("li",[v._v("-tt 不对每行输出的时间进行格式处理")]),v._v(" "),_("li",[v._v("-ttt 输出时每两行打印之间会延迟一个时间段，以毫秒为单位")]),v._v(" "),_("li",[v._v("-v 输出一个稍微详细的信息，例如在 ip 包中可以包括 ttl 和服务类型的信息")]),v._v(" "),_("li",[v._v("-vv 输出说细的报文信息")]),v._v(" "),_("li",[v._v("-vvv 输出比 -vv 更详细的信息")])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"tcpdump-2"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#tcpdump-2"}},[v._v("#")]),v._v(" tcpdump")]),v._v(" "),_("p",[v._v("示例：")]),v._v(" "),_("ul",[_("li",[_("code",[v._v("tcpdump -i eth0")]),v._v(" 抓取 eth0 网卡接口数据包")]),v._v(" "),_("li",[_("code",[v._v("tcpdump -i any")]),v._v(" 抓取所有网卡接口数据包")]),v._v(" "),_("li",[_("code",[v._v("tcpdump -i eth0 arp")]),v._v(" 基于协议抓取数据包")]),v._v(" "),_("li",[_("code",[v._v("tcpdump -w /path/to/file.pcap")]),v._v(" 保存数据包信息到文件，可用 wirshark 打开分析")]),v._v(" "),_("li",[_("code",[v._v("tcpdump -n -i eth0 net 192.168.2.2 and port 53")]),v._v(" 抓取指定地址和端口的网络数据包")]),v._v(" "),_("li",[_("code",[v._v("tcpdump -n -i eth0 src 192.168.2.3 and port 80")]),v._v(" 抓取指定源定地和端口的数据包")])]),v._v(" "),_("slide"),v._v(" "),_("h4",{attrs:{id:"tcpdump-3"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#tcpdump-3"}},[v._v("#")]),v._v(" tcpdump")]),v._v(" "),_("p",[v._v("理解输出：")]),v._v(" "),_("ul",[_("li",[_("a",{attrs:{href:"http://www.tcpdump.org/manpages/tcpdump.1.html#lbAG",target:"_blank",rel:"noopener noreferrer"}},[v._v("官方文档"),_("OutboundLink")],1)]),v._v(" "),_("li",[v._v("具体的字段根据不同的报文类型会有所不同，一般格式如下：\n"),_("ul",[_("li",[v._v("第一字段是数据包被抓取时的本地时间戳")]),v._v(" "),_("li",[v._v("第二个字段是网络层协议类型")]),v._v(" "),_("li",[v._v("第三个字段是源 IP 地址和端口")]),v._v(" "),_("li",[v._v("第四个字段是目标 IP 地址和端口")]),v._v(" "),_("li",[v._v("第五个字段数据包参数")])])]),v._v(" "),_("li",[v._v("flags 字段通常取值如下：\n"),_("ul",[_("li",[v._v("[S] SYN 开始连接")]),v._v(" "),_("li",[v._v("[.] ACK 成功接收或没有标记")]),v._v(" "),_("li",[v._v("[P] PUSH 数据推送")]),v._v(" "),_("li",[v._v("[F] FIN 结束连接")]),v._v(" "),_("li",[v._v("[R] RST 重启连接")]),v._v(" "),_("li",[v._v("[U] URG 紧急报文，优先处理")]),v._v(" "),_("li",[v._v("[E] ECE 阻塞通知")]),v._v(" "),_("li",[v._v("[W] CWR 阻塞窗口变小")])])])])],1)}),[],!1,null,null,null);_.default=l.exports}}]);